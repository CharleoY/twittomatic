<!doctype html>
<head>
  <title>Twitter crawler: Monitor</title>
  <script src="static/jquery-1.8.3.js"></script>
  <script src="static/jquery.graphite.js"></script>
  <link href="static/css/bootstrap.min.css" rel="stylesheet" media="screen">
</head>
<body>
<div class="container">
  <h1>Status</h1>
  {% for message in get_flashed_messages() %}
    <div class="alert">{{ message }}</div>
  {% endfor %}
  {% block body %}

    <img id="graph" class="img-polaroid">

    <div class="progress">
      <div class="bar bar-success" style="width: 35%;"></div>
      <div class="bar bar-warning" style="width: 20%;"></div>
      <div class="bar bar-danger" style="width: 10%;"></div>
    </div>
    
    <h2>Summary</h2>

    <div id="summary-table" class="row">
      <div class="span4">
        <table class="table table-striped table-bordered table-hover table-condensed">
          <thead>
          <tr><th>Key</th><th>Value</th></tr>
          </thead>
          {% for key, value in statistics|dictsort %}                       
          <tr><td>{{ key }}</td><td>{{ value }}</td></tr>     
          {% endfor %}
        </table>
      </div>

      <div class="span4">
        <table class="table table-striped table-bordered table-hover table-condensed">
        {% for message in stream %}
        <tr><th class='bold'>Stream jobs</th></td>
        <tr><td>{{ message }}</td></th>
        {% endfor %}
        </table>
      </div>

      <div class="span4">
        <table class="table table-striped table-bordered table-hover table-condensed">
        <tr><th>Error jobs</th></td>
        {% for message in error_stream %}
        <tr><td>{{ message }}</td></th>
        {% endfor %}
        </table>
      </div>
    </div>
<script>
$("#graph").graphite({
    from: "-24hours",
    url: "http://localhost:8080/render/",
    target: [
        "alias(sumSeries(stats.ops.timeline.*), 'Timeline')",
    ],
});
</script>
  {% endblock %}
</div>
</body>